import{c as O,e as H}from"./chunk-5WNGUU2R.js";import{d as A}from"./chunk-EGSPEJGI.js";import"./chunk-EJGX32BV.js";import"./chunk-NME53Y3J.js";import{g as I,h as V,i as N,j as D,k as $,l as Q}from"./chunk-EH3GIMEI.js";import{a as B,g as W}from"./chunk-6TMERT2D.js";import"./chunk-LAR6TP5T.js";import{$b as _,Eb as C,Ec as P,Jb as n,Kb as o,Lb as s,Mb as F,Nb as S,Pb as w,Rb as h,Sb as l,Wb as T,Xb as E,Yb as k,ac as r,bc as M,cc as y,d,db as c,ib as v,oa as x,ob as b,pa as f,sb as p,zb as g}from"./chunk-DSW3PZOY.js";var U=["textbox"];function j(i,u){if(i&1&&(F(0),r(1),S()),i&2){let e=l(2);c(),y("File opened: ",e.fileHandle.name,"")}}function q(i,u){if(i&1){let e=w();n(0,"button",18),h("click",function(){x(e),l();let a=_(12),m=l();return f(m.saveFile(a.value))}),s(1,"img",19),r(2," Save "),o()}}function R(i,u){if(i&1){let e=w();n(0,"div",5)(1,"p",9),p(2,j,2,1,"ng-container",10),o(),n(3,"div",11)(4,"button",12),h("click",function(){x(e);let a=l();return f(a.openFile())}),s(5,"img",13),r(6," Open "),o(),n(7,"button",12),h("click",function(){x(e);let a=_(12),m=l();return f(m.saveAs(a.value))}),s(8,"img",14),r(9," Save as "),o(),p(10,q,3,0,"button",15),o(),s(11,"textarea",16,0),n(13,"cite"),r(14,"For demo purposes, only .txt files are accepted."),o(),n(15,"p",17),r(16),o()()}if(i&2){let e=l();c(2),g("ngIf",e.fileHandle),c(8),g("ngIf",e.fileHandle),c(6),y(" ",e.errorText," ")}}function Y(i,u){if(i&1&&(n(0,"h2"),r(1),o()),i&2){let e=l();c(),M(e.unsupportedText)}}function z(i,u){i&1&&(n(0,"div",20),s(1,"img",21),o(),s(2,"br")(3,"br"),n(4,"a",22),r(5,"Source: can I use"),o())}var ne=(()=>{class i{constructor(e){this.titleService=e,this.titleService.setTitle("File System")}ngOnInit(){!("chooseFileSystemEntries"in window)&&!("showOpenFilePicker"in window)&&(this.unsupportedText="Your browser does not support File System Access API or you did not activate the Chrome flag.")}ngAfterViewInit(){this.textAreaElement=this.textarea.nativeElement}openFile(){return d(this,null,function*(){try{this.fileHandle=yield this.getFileHandle();let e=yield this.fileHandle.getFile();this.textAreaElement.value=yield e.text()}catch(e){if(e instanceof DOMException)switch(e.name){case"AbortError":this.errorText="File selection aborted by the user or system.";break;case"NotAllowedError":this.errorText="Permission to read the file was denied.";break;case"NotFoundError":this.errorText="The selected file was not found.";break;case"SecurityError":this.errorText="File access was denied due to a security policy (e.g., not a user gesture).";break;default:this.errorText=`An unexpected file system error occurred: ${e.message} (Code: ${e.name})`}else e instanceof TypeError?this.errorText=`A type error occurred during file open: ${e.message}`:this.errorText=`An unexpected error occurred during file open: ${e.message||"Unknown error"}`;console.error(e)}})}saveFile(e){return d(this,null,function*(){try{if(this.fileHandle)yield this.writeTextFile(this.fileHandle,e);else return yield this.saveAs(e)}catch(t){this.errorText=t.message,console.error(t)}})}saveAs(e){return d(this,null,function*(){try{this.fileHandle=yield this.getNewFileHandle(),yield this.writeTextFile(this.fileHandle,e)}catch(t){if(t instanceof DOMException)switch(t.name){case"AbortError":this.errorText="File saving operation was aborted by the user or system.";break;case"NotAllowedError":this.errorText="Permission to save the file was denied.";break;case"NotFoundError":this.errorText="The file to save to was not found or became invalid.";break;case"NoModificationAllowedError":this.errorText="Modification of the file was not allowed (e.g., file locked or exclusive write conflict).";break;case"SecurityError":this.errorText="File saving was denied due to a security policy.";break;default:this.errorText=`An unexpected file system error occurred during save: ${t.message} (Code: ${t.name})`}else this.errorText=`An unexpected error occurred during save: ${t.message||"Unknown error"}`;console.error(t)}})}writeTextFile(e,t){return d(this,null,function*(){let a=yield e.createWritable();a.write(t),a.close()})}getFileHandle(){return d(this,null,function*(){let e=this.getFilePickerOptions();return window.showOpenFilePicker(e).then(t=>t[0])})}getNewFileHandle(){let e={};return e=this.getFilePickerOptions(),window.showSaveFilePicker(e)}getFilePickerOptions(e="open-file"){return"showSaveFilePicker"in window?{types:[{description:"Text files",accept:{"text/plain":[".txt"]}}]}:{type:e,accepts:[{description:"Text files",mimeTypes:["text/plain"],extensions:["txt"]}]}}static{this.\u0275fac=function(t){return new(t||i)(v(A))}}static{this.\u0275cmp=b({type:i,selectors:[["app-file-system"]],viewQuery:function(t,a){if(t&1&&T(U,5),t&2){let m;E(m=k())&&(a.textarea=m.first)}},decls:25,vars:1,consts:[["textbox",""],[1,"content"],[1,"descr-card"],[1,"flex-centered"],["src","assets/icons/lock.png","width","24","height","24","alt","lock icon",1,"icon-space"],[1,"native-demo"],[1,"accordion-container"],["multi","",1,"example-headers-align"],["matExpansionPanelContent",""],[1,"file-name"],[4,"ngIf"],[1,"action-bar"],["mat-raised-button","",3,"click"],["src","assets/icons/folder.png","width","24","height","24","alt","folder_open icon",1,"icon-space"],["src","assets/icons/playlist_add.png","width","24","height","24","alt","playlist_add icon",1,"icon-space"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["name","textbox","id","textbox","rows","15","placeholder"," Start writing your biography and save it for the future generations... \u{1F447}"],[1,"error"],["color","primary","mat-raised-button","",3,"click"],["src","assets/icons/save.png","width","24","height","24","alt","save icon",1,"icon-space"],[1,"img-container"],["src","assets/images/native-file.png","alt","Native File System api support"],["href","https://caniuse.com/native-filesystem-api","target","_blank"]],template:function(t,a){t&1&&(n(0,"section",1)(1,"h1"),r(2,"File System Access API"),o(),n(3,"mat-card",2)(4,"p"),r(5," The "),n(6,"strong"),r(7,"File System Access API"),o(),r(8," offers new features to manipulate local files and provide an improved experience similar to a desktop/native app. We don't have to download the file each time we want to edit it, but we can save it directly. We could even implement an auto-save functionality if needed. "),s(9,"br")(10,"br"),n(11,"span",3),s(12,"img",4),n(13,"span"),r(14,"This feature is available only over secure connections (HTTPS) and through user interaction."),o()()()(),p(15,R,17,3,"div",5)(16,Y,2,1,"h2"),n(17,"div",6)(18,"mat-accordion",7)(19,"mat-expansion-panel")(20,"mat-expansion-panel-header")(21,"mat-panel-title")(22,"h1"),r(23,"Browser compatibility"),o()()(),p(24,z,6,0,"ng-template",8),o()()()()),t&2&&(c(15),C(a.unsupportedText?16:15))},dependencies:[W,B,P,H,O,Q,$,V,N,D,I],styles:[".native-demo[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]{margin-bottom:1rem}.native-demo[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:1rem}.native-demo[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}.native-demo[_ngcontent-%COMP%]   p.file-name[_ngcontent-%COMP%]{height:20px}.native-demo[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%}"]})}}return i})();export{ne as FileSystemComponent};
