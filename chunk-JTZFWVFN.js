import{a as A,d as V}from"./chunk-LM2QGAUZ.js";import{d as D,e as N,f as Q,g as B,h as W,i as R}from"./chunk-LAEGQYIL.js";import{a as j,g as q}from"./chunk-764RPA4D.js";import"./chunk-OFTKMGOF.js";import{$a as s,Ab as T,Bb as M,Db as k,Eb as I,Fa as p,Ga as S,Oa as h,Ua as f,Xb as O,Za as n,_a as i,ab as F,bb as b,c as d,da as C,db as w,ha as u,hb as _,ia as g,jb as m,mb as v,nb as a,ob as E,pb as y,qc as H,ub as P}from"./chunk-TX2EYQ2R.js";var Y=["textbox"];function z(o,l){if(o&1&&(F(0),a(1),b()),o&2){let r=m(2);p(1),y("File opened: ",r.fileHandle.name,"")}}function G(o,l){if(o&1){let r=w();n(0,"button",21),_("click",function(){u(r),m();let t=v(12),c=m();return g(c.saveFile(t.value))}),s(1,"img",22),a(2," Save "),i()}}function J(o,l){if(o&1){let r=w();n(0,"div",10)(1,"p",11),f(2,z,2,1,"ng-container",12),i(),n(3,"div",13)(4,"button",14),_("click",function(){u(r);let t=m();return g(t.openFile())}),s(5,"img",15),a(6," Open "),i(),n(7,"button",14),_("click",function(){u(r);let t=v(12),c=m();return g(c.saveAs(t.value))}),s(8,"img",16),a(9," Save as "),i(),f(10,G,3,0,"button",17),i(),s(11,"textarea",18,19),n(13,"cite"),a(14,"For demo purposes, only .txt files are accepted."),i(),n(15,"p",20),a(16),i()()}if(o&2){let r=m();p(2),h("ngIf",r.fileHandle),p(8),h("ngIf",r.fileHandle),p(6),y(" ",r.errorText," ")}}function K(o,l){if(o&1&&(n(0,"h2"),a(1),i()),o&2){let r=m();p(1),E(r.unsupportedText)}}function L(o,l){o&1&&(n(0,"div",23),s(1,"img",24),i(),s(2,"br")(3,"br"),n(4,"a",25),a(5,"Source: can I use"),i())}var oe=(()=>{let l=class l{constructor(e){this.titleService=e,this.titleService.setTitle("File System")}ngOnInit(){!("chooseFileSystemEntries"in window)&&!("showOpenFilePicker"in window)&&(this.unsupportedText="Your browser does not support File System Access API or you did not activate the Chrome flag.")}ngAfterViewInit(){this.textAreaElement=this.textarea.nativeElement}openFile(){return d(this,null,function*(){try{this.fileHandle=yield this.getFileHandle();let e=yield this.fileHandle.getFile();this.textAreaElement.value=yield e.text()}catch(e){this.errorText=e.message,console.error(e)}})}saveFile(e){return d(this,null,function*(){try{if(this.fileHandle)yield this.writeTextFile(this.fileHandle,e);else return yield this.saveAs(e)}catch(t){this.errorText=t.message,console.error(t)}})}saveAs(e){return d(this,null,function*(){try{this.fileHandle=yield this.getNewFileHandle(),yield this.writeTextFile(this.fileHandle,e)}catch(t){this.errorText=t.message,console.error(t)}})}writeTextFile(e,t){return d(this,null,function*(){let c=yield e.createWritable();c.write(t),c.close()})}getFileHandle(){return d(this,null,function*(){let e=this.getFilePickerOptions();return window.showOpenFilePicker(e).then(t=>t[0])})}getNewFileHandle(){let e={};return e=this.getFilePickerOptions(),window.showSaveFilePicker(e)}getFilePickerOptions(e="open-file"){return"showSaveFilePicker"in window?{types:[{description:"Text files",accept:{"text/plain":[".txt"]}}]}:{type:e,accepts:[{description:"Text files",mimeTypes:["text/plain"],extensions:["txt"]}]}}};l.\u0275fac=function(t){return new(t||l)(S(H))},l.\u0275cmp=C({type:l,selectors:[["app-file-system"]],viewQuery:function(t,c){if(t&1&&M(Y,5),t&2){let x;T(x=k())&&(c.textarea=x.first)}},standalone:!0,features:[P],decls:31,vars:2,consts:[[1,"content"],[1,"descr-card"],[1,"flex-centered"],["src","assets/icons/lock.png","width","24","height","24","alt","lock icon",1,"icon-space"],["src","assets/icons/warning.png","width","24","height","24","alt","warning icon",1,"icon-space"],["class","native-demo",4,"ngIf","ngIfElse"],["noSupported",""],[1,"accordion-container"],["multi","",1,"example-headers-align"],["matExpansionPanelContent",""],[1,"native-demo"],[1,"file-name"],[4,"ngIf"],[1,"action-bar"],["mat-raised-button","",3,"click"],["src","assets/icons/folder_open.png","width","24","height","24","alt","folder_open icon",1,"icon-space"],["src","assets/icons/playlist_add.png","width","24","height","24","alt","playlist_add icon",1,"icon-space"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["name","textbox","id","textbox","rows","15","placeholder"," Start digiting your biography and save it for the future generations... \u{1F447}"],["textbox",""],[1,"error"],["color","primary","mat-raised-button","",3,"click"],["src","assets/icons/save.png","width","24","height","24","alt","save icon",1,"icon-space"],[1,"img-container"],["src","assets/images/native-file.png","alt","Native File System api support"],["href","https://caniuse.com/native-filesystem-api","target","_blank"]],template:function(t,c){if(t&1&&(n(0,"section",0)(1,"h1"),a(2,"File System Access API"),i(),n(3,"mat-card",1)(4,"p"),a(5,"The "),n(6,"strong"),a(7,"File System Access API"),i(),a(8," offers new features to manipulate local files and provide an improved experience similar to a desktop/native app. We don't have to download the file each time we want to edit it, but we can save it directly. We could even implement an auto-save functionality if needed. "),s(9,"br")(10,"br"),n(11,"span",2),s(12,"img",3),n(13,"span"),a(14,"This feature is available only over secure connections (HTTPS) and through user interaction."),i()(),s(15,"br"),n(16,"span",2),s(17,"img",4),a(18," Active by default from Chrome 86. "),i(),a(19," In older Chrome versions you might need to enable the related flag in Chrome to test it (chrome://flags/#native-file-system-api). "),i()(),f(20,J,17,3,"div",5)(21,K,2,1,"ng-template",null,6,I),n(23,"div",7)(24,"mat-accordion",8)(25,"mat-expansion-panel")(26,"mat-expansion-panel-header")(27,"mat-panel-title")(28,"h1"),a(29,"Browser compatibility"),i()()(),f(30,L,6,0,"ng-template",9),i()()()()),t&2){let x=v(22);p(20),h("ngIf",!c.unsupportedText)("ngIfElse",x)}},dependencies:[q,j,O,V,A,R,W,N,Q,B,D],styles:[".native-demo[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]{margin-bottom:1rem}.native-demo[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:1rem}.native-demo[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}.native-demo[_ngcontent-%COMP%]   p.file-name[_ngcontent-%COMP%]{height:20px}.native-demo[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%}"]});let o=l;return o})();export{oe as FileSystemComponent};
